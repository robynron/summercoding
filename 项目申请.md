<center><font size=20 face="黑体">项目申请书</font></center>

<center><font size=3 face="黑体">项目名称：支持GTS通信协议和消息</font></center>

<center><font size=3 face="黑体">项目主导师：赵学良</font></center>

<center><font size=3 face="黑体">申请人：刘戎</font></center>

<center><font size=3 face="黑体">日期：2022.6</font></center>

<center><font size=3 face="黑体">邮箱：767817253@qq.com</font></center>



# 1.项目背景

## 1.1 项目需求

目前Seata支持了自定义协议格式参考 https://github.com/seata/seata/issues/893，需要进一步支持TXC/GTS 产品的通信协议，在seata-server侧能够无缝兼容2种通信协议并且支持TXC/GTS 的事务消息处理，以达到使用TXC/GTS  client的用户也可以通过 txc-client 使用 seata-server 提供的分布式事务服务。

# 2.技术方法及可行性

## 2.1 seata相关

2022年四月份担任阿里巴巴MSE团队分布式事务服务的实习生，期间调研了seata的事务模式，并在seata社区解决了部分issue，对seata的工作模型较为了解。





# 3.项目实现细节

## 3.1 seata/gts架构对比

![seata/gts架构图](https://github.com/robynron/summercoding/blob/master/seata:gts.png)
在GTS的产品介绍中，可知Seata 的分布式事务框架源自 GTS，二者的底层架构和事务协议是完全一致的：
* GTS 把 TM 和 RM 的实现统一打包到 GTS SDK（GTS Client） 中。
* GTS 服务端（GTS Server）就是 TC 的一个高可用实现。
  基于上述对比，只要实现具体网络通信机制上的兼容适配，就可以完整支撑 Seata 应用运行在 GTS 服务之上。

## 3.2 seata通信协议

seata-server在 [issues #893](https://github.com/seata/seata/issues/893) 中重新定义了rpc协议：
```
0     1     2     3     4     5     6     7     8     9     10    11    12    13    14    15    16
+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+
|   magic   |Proto|     Full length       |    Head   | Msg |Seria|Compr|     RequestId         |
|   code    |colVer|    （head+body)      |   Length  |Type |lizer|ess  |                       |
+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+
|                                                                                               |
|                                   Head Map [Optional]                                         |
+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+
|                                                                                               |
|                                         body                                                  |
|                                                                                               |
|                                        ... ...                                                |
+-----------------------------------------------------------------------------------------------+
```

# 4.规划

## 4.1 项目研发第一阶段



## 4.2 项目研发第二阶段



## 4.3 期望



